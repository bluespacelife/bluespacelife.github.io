<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    
<link rel="stylesheet" href="/css/bootstrap.min.css">

    
<link rel="stylesheet" href="/css/bluespacelife.css">


    <!-- system0 -->
    
<link rel="stylesheet" href="/css/system0/system0.css">

     
<meta name="generator" content="Hexo 5.4.0"></head>


<script src="/js/jquery.slim.min.js"></script>


<script src="/js/bluespacelife.js"></script>



<body>
  <article id="post">
    <h1>
      Netty粘包和拆包
    </h1>
    <h2 id="TCP-粘包-拆包的原因及解决方法？"><a href="#TCP-粘包-拆包的原因及解决方法？" class="headerlink" title="TCP 粘包/拆包的原因及解决方法？"></a>TCP 粘包/拆包的原因及解决方法？</h2><ul>
<li>TCP是以流的方式来处理数据，一个完整的包可能会被TCP拆分成多个包进行发送，也可能把小的封装成一个大的数据包发送。</li>
<li>TCP粘包/分包的原因：<ul>
<li>应用程序写入的字节大小大于套接字发送缓冲区的大小，会发生拆包现象</li>
<li>而应用程序写入数据小于套接字缓冲区大小，网卡将应用多次写入的数据发送到网络上，这将会发生粘包现象</li>
<li>进行MSS大小的TCP分段，当TCP报文长度-TCP头部长度&gt;MSS的时候将发生拆包</li>
<li>以太网帧的payload（净荷）大于MTU（1500字节）进行ip分片</li>
</ul>
</li>
<li>解决方法</li>
<li>消息定长：FixedLengthFrameDecoder类</li>
<li>包尾增加特殊字符分割：行分隔符类：LineBasedFrameDecoder或自定义分隔符类：DelimiterBasedFrameDecoder</li>
<li>将消息分为消息头和消息体：LengthFieldBasedFrameDecoder类，分为有头部的拆包与粘包、长度字段在前且有头部的拆包与粘包、多扩展头部的拆包与粘包</li>
</ul>

  </article>

  <div id="paginator">
    
  </div>
</body>

</html>